{"ast":null,"code":"import _toConsumableArray from\"C:/Users/folki/pwa/pwa-course-2021/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/folki/pwa/pwa-course-2021/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./Chatbox.css';import{useEffect,useState}from'react';import App from'./App';import firebase from'./firebaseConfig';// ส่งคอนฟิกมาใช้งาน\nimport{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var chatroomRef=firebase.database().ref('chatroom-1');function Chatbox(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),lines=_useState4[0],setLines=_useState4[1];// [\"-้กดกด\",\"กกกกก\",\"กกกหกดหกดหกด\"]\n// [{sender: \"Mon\", message: \"skldfsjdlkfsd\", timestamp: 12387687437424}, {sender: \"Mon\", message: \"slkdjfsdlkfline2\", timestamp: 123434234}]\nuseEffect(function(){chatroomRef.on('child_added',function(snapshot){var x=snapshot.val();setLines(function(l){return[].concat(_toConsumableArray(l),[{sender:x.sender,message:x.message,timestamp:new Date()}]);});});},[]);var onTextChange=function onTextChange(event){setText(event.target.value);};var onSend=function onSend(){//push mesaage to firebase server\nchatroomRef.push({sender:\"เชน : \",message:text,timestamp:firebase.database.ServerValue.TIMESTAMP});setText(\"\");};var keyPress=function keyPress(event){if(event.which===13){onSend();}};return/*#__PURE__*/_jsx(App,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"App-chatroom\",children:lines.map(function(x){return/*#__PURE__*/_jsxs(\"div\",{className:\"App-chatroom-text\",children:[x.sender,x.message]});})}),/*#__PURE__*/_jsxs(\"div\",{className:\"App-textbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"App-textbox-input\",value:text,onChange:onTextChange,onKeyPress:keyPress}),/*#__PURE__*/_jsx(\"div\",{className:\"App-textbox-send\",onClick:onSend,children:\"Send!\"})]})]})});}export default Chatbox;","map":{"version":3,"sources":["C:/Users/folki/pwa/pwa-course-2021/src/Chatbox.js"],"names":["useEffect","useState","App","firebase","chatroomRef","database","ref","Chatbox","text","setText","lines","setLines","on","snapshot","x","val","l","sender","message","timestamp","Date","onTextChange","event","target","value","onSend","push","ServerValue","TIMESTAMP","keyPress","which","map"],"mappings":"0TAAA,MAAO,eAAP,CACA,OAAQA,SAAR,CAAmBC,QAAnB,KAAkC,OAAlC,CACA,MAAOC,CAAAA,GAAP,KAAgB,OAAhB,CACA,MAAOC,CAAAA,QAAP,KAAqB,kBAArB,CAAwC;wFAExC,GAAMC,CAAAA,WAAW,CAAGD,QAAQ,CAACE,QAAT,GAAoBC,GAApB,CAAwB,YAAxB,CAApB,CAGA,QAASC,CAAAA,OAAT,EAAmB,eACON,QAAQ,CAAC,EAAD,CADf,wCACVO,IADU,eACJC,OADI,8BAESR,QAAQ,CAAC,EAAD,CAFjB,yCAEVS,KAFU,eAEHC,QAFG,eAGjB;AACA;AAEAX,SAAS,CAAC,UAAM,CACdI,WAAW,CAACQ,EAAZ,CAAe,aAAf,CAA8B,SAAAC,QAAQ,CAAI,CACxC,GAAIC,CAAAA,CAAC,CAAGD,QAAQ,CAACE,GAAT,EAAR,CACAJ,QAAQ,CAAC,SAAAK,CAAC,qCAAQA,CAAR,GAAW,CACnBC,MAAM,CAAEH,CAAC,CAACG,MADS,CAEnBC,OAAO,CAAEJ,CAAC,CAACI,OAFQ,CAGnBC,SAAS,CAAG,GAAIC,CAAAA,IAAJ,EAHO,CAAX,IAAF,CAAR,CAKD,CAPD,EASD,CAVQ,CAUN,EAVM,CAAT,CAYA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,KAAD,CAAW,CAC9Bb,OAAO,CAACa,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAP,CACD,CAFD,CAIA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAK,CAClB;AACArB,WAAW,CAACsB,IAAZ,CAAiB,CACfT,MAAM,CAAE,QADO,CAEfC,OAAO,CAAEV,IAFM,CAGfW,SAAS,CAAEhB,QAAQ,CAACE,QAAT,CAAkBsB,WAAlB,CAA8BC,SAH1B,CAAjB,EAKAnB,OAAO,CAAC,EAAD,CAAP,CACD,CARD,CAUA,GAAMoB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACP,KAAD,CAAW,CAC1B,GAAIA,KAAK,CAACQ,KAAN,GAAgB,EAApB,CAAuB,CACrBL,MAAM,GACP,CACF,CAJD,CAMA,mBACE,KAAC,GAAD,wBACI,aAAK,SAAS,CAAC,KAAf,wBACI,YAAK,SAAS,CAAC,cAAf,UAEIf,KAAK,CAACqB,GAAN,CAAU,SAAAjB,CAAC,CAAI,CACX,mBAAO,aAAK,SAAS,CAAC,mBAAf,WACEA,CAAC,CAACG,MADJ,CAEEH,CAAC,CAACI,OAFJ,GAAP,CAKC,CANL,CAFJ,EADJ,cAYA,aAAK,SAAS,CAAC,aAAf,wBACI,cAAO,IAAI,CAAC,MAAZ,CAAmB,SAAS,CAAC,mBAA7B,CACA,KAAK,CAAEV,IADP,CACa,QAAQ,CAAEa,YADvB,CACqC,UAAU,CAAEQ,QADjD,EADJ,cAII,YAAK,SAAS,CAAC,kBAAf,CAAkC,OAAO,CAAEJ,MAA3C,mBAJJ,GAZA,GADJ,EADF,CAuBD,CAED,cAAelB,CAAAA,OAAf","sourcesContent":["import './Chatbox.css';\r\nimport {useEffect, useState} from 'react';\r\nimport App from './App';\r\nimport firebase from './firebaseConfig' // ส่งคอนฟิกมาใช้งาน\r\n\r\nconst chatroomRef = firebase.database().ref('chatroom-1');\r\n\r\n\r\nfunction Chatbox() {\r\n  const [text, setText] = useState(\"\");\r\n  const [lines, setLines] = useState([]);\r\n  // [\"-้กดกด\",\"กกกกก\",\"กกกหกดหกดหกด\"]\r\n  // [{sender: \"Mon\", message: \"skldfsjdlkfsd\", timestamp: 12387687437424}, {sender: \"Mon\", message: \"slkdjfsdlkfline2\", timestamp: 123434234}]\r\n  \r\n  useEffect(() => {\r\n    chatroomRef.on('child_added', snapshot => {\r\n      let x = snapshot.val();\r\n      setLines(l => [...l, {\r\n        sender: x.sender,\r\n        message: x.message,\r\n        timestamp: (new Date())\r\n      }])\r\n    });\r\n\r\n  }, []);\r\n\r\n  const onTextChange = (event) => {\r\n    setText(event.target.value);\r\n  };\r\n\r\n  const onSend = () =>{\r\n    //push mesaage to firebase server\r\n    chatroomRef.push({\r\n      sender: \"เชน : \",\r\n      message: text,\r\n      timestamp: firebase.database.ServerValue.TIMESTAMP\r\n    });\r\n    setText(\"\");\r\n  };\r\n\r\n  const keyPress = (event) => {\r\n    if (event.which === 13){\r\n      onSend();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <App>\r\n        <div className=\"App\">\r\n            <div className=\"App-chatroom\">\r\n                {\r\n                lines.map(x => {\r\n                    return <div className=\"App-chatroom-text\">\r\n                            {x.sender}\r\n                            {x.message}\r\n                             \r\n                        </div>\r\n                    })\r\n                }\r\n            </div>\r\n        <div className=\"App-textbox\">\r\n            <input type=\"text\" className=\"App-textbox-input\" \r\n            value={text} onChange={onTextChange} onKeyPress={keyPress}/>\r\n            \r\n            <div className=\"App-textbox-send\" onClick={onSend}>Send!</div>\r\n            </div>\r\n        </div>\r\n    </App>\r\n  );\r\n}\r\n\r\nexport default Chatbox;\r\n"]},"metadata":{},"sourceType":"module"}